# TimeBlock Planner 개선 계획(Frontend/UI 중심) – 최종본

작성일: 2025-12-14

## 0) 범위/제약

### 범위(포함)
- Electron Renderer(React + TypeScript) UI/UX 개선: 화면 구성, 상호작용, 상태 표현, 접근성, 성능, 일관성
- 상태/데이터 흐름 “사용 방식” 개선: Zustand Store 사용 패턴 정리, Repository 호출 경계 준수, 에러/로딩/동기화 상태의 UI 표현
- 디자인 시스템 준수 하에서 컴포넌트 조합/정리(기존 컴포넌트/토큰 사용)
- 릴리즈 게이트(ADHD 친화) 체크리스트 운영 및 품질 기준(DoD) 표준화

### 범위(제외: 구현 금지)
- Backend(Supabase/Firebase Functions) 기능 구현/수정
- Supabase 스키마/마이그레이션/정책(RLS) 변경
- Electron IPC(메인/프리로드) 신규 구현 또는 프로토콜 변경

### 설계 고려(허용)
- 위 “제외” 영역은 UI 요구에 의해 인터페이스/이벤트/데이터 계약 관점으로만 고려한다(예: “동기화 상태를 표준화된 이벤트로 제공해야 함”).

### 프로젝트 규칙(문서 전반 공통)
- **localStorage 금지**: 단, `theme` 키는 Dexie 초기화 전 예외. 그 외 지속 상태는 **Dexie의 `systemState`** 사용.
- **기본값 하드코딩 금지**: 모든 기본값은 **`SETTING_DEFAULTS`(단일 출처)** 를 사용.
- **Optional Chaining 필수**: 중첩 객체 접근은 `?.` 및 `??`로 런타임 에러 방지.
- **모달 닫기 UX 통일**: 배경 클릭으로 닫지 않음. **ESC로 닫힘 필수**(가능하면 `useModalEscapeClose`).

### 현황 스냅샷(코드 기반 근거)
- (정책 충돌 가능) Zustand `persist`가 기본 storage(localStorage)에 의존할 수 있음: `src/shared/stores/uiStore.ts`
- (기본값 하드코딩 확인) 모달/화면 일부에서 `SETTING_DEFAULTS` 대신 숫자 상수 사용 사례가 존재(우선 P0에서 정리)
- (모달 UX 위반 확인) “배경 클릭으로 닫히지 않음” 규칙과 어긋나는 케이스가 존재(우선 P0에서 통일)
- (준수 사례 다수) `useModalEscapeClose` 사용 모달이 여러 곳에 존재하므로, 위반 케이스는 패턴 통일로 빠르게 수습 가능

---

## 1) 목표/원칙/성공지표

### 목표(사용자 가치)
- “지금 무엇을 해야 하는지”가 즉시 보이는 **인지 부하 최소 UI**
- 작업 추가/이동/완료까지의 **마찰(클릭/입력) 최소화**
- 동기화/저장/오류 상태가 명확해 **불안(uncertainty)을 제거**

### 원칙(설계/구현)
- **일관성 우선**: 동일 액션은 동일 패턴(버튼 위치, 라벨, 단축키, 피드백)으로 제공
- **가시성 우선**: 상태(로딩/저장/오류/동기화)와 결과(완료/보상)를 즉시 피드백
- **안전한 기본값**: 잘못된 조작을 줄이고(확인/undo) “실수 비용”을 낮춤
- **규칙 준수로 버그 예방**: localStorage 금지, defaults 단일출처, optional chaining, 모달 UX 표준

### 성공지표(측정 가능)
- **핵심 플로우 소요시간**
  - 새 작업 추가 → 블록 배치까지의 평균 소요시간 20% 감소
  - 블록 내 작업 완료 처리 15% 감소
- **실패/불확실성 지표**
  - 저장/동기화 관련 사용자 재시도(반복 클릭) 발생률 감소(UX 계측이 없다면 QA 체크리스트 기반으로 대체)
  - 오류 발생 시 “다음 행동을 모름” 케이스 0건(DoD로 강제)
- **품질 지표**
  - 릴리즈 게이트(섹션 4) 100% 통과
  - 변경 영향도 큰 화면(일정/인박스/포커스/설정)에서 회귀 QA 체크리스트 통과

---

## 2) 우선순위 로드맵(1~3단계)

### 1단계: UX 위생(Hygiene) + 상태 표현 표준화 (2~3주)
- 로딩/저장/동기화/오류의 UI 표준 패턴 정의 및 적용
- 모달/다이얼로그 UX 통일(ESC, 배경 클릭 금지, 포커스 트랩/초점 관리)
- 기본 컴포넌트 조합/레이아웃 일관화(헤더, CTA 위치, 빈 상태)
- 성능 핫스팟(불필요 리렌더/큰 리스트) 최소화(측정 기반)

### 2단계: 핵심 플로우 마찰 제거(Workflow Optimization) (3~5주)
- 일정 편집(드래그/키보드/빠른 추가) 플로우 간소화
- 작업/블록 완료 피드백 강화(진행/보상/되돌리기)
- 집중/휴식 UX(포커스 기능)에서 “방해 요소 최소” UI 규칙 적용

### 3단계: 개인화/인사이트(유지 동기 강화) (4~6주)
- 설정/프로필/게임화 화면의 정보 구조 정리(과다 옵션을 단계적으로 노출)
- 인사이트 화면: 오늘/이번 주의 핵심 요약을 “행동 제안” 중심으로 재구성
- 전반적인 접근성(키보드 내비게이션, 스크린리더 기본) 강화

---

## 3) 실행 백로그

> 표기: **공수 추정** S(≤1일) / M(2~4일) / L(1~2주)

### P0 (이번 릴리즈에 필수: 안정성/일관성/인지부하)

1) 상태 표현(로딩/저장/동기화/오류) UI 패턴 표준화
- 기대효과: “앱이 멈췄나?” 불안 감소, 재시도/중복 클릭 감소
- 리스크: 화면별로 상태 소스가 달라 일관 적용이 어렵고, 과표시(너무 많은 토스트)로 산만해질 수 있음
- DoD: 주요 화면(일정/인박스/설정/포커스)에 동일한 상태 컴포넌트/문구 규칙 적용, 오류 발생 시 복구 액션(재시도/로그 보기/설정 이동 등) 제공
- 공수: M

2) 모달 UX 통일(배경 클릭 닫기 금지 + ESC 닫기 + 포커스 관리)
- 기대효과: 실수로 닫힘/작업 손실 방지, ADHD 사용자에게 예측 가능한 인터랙션 제공
- 리스크: 기존 모달들이 서로 다른 패턴으로 구현돼 있어 회귀 가능
- DoD: 모든 모달이 (a) 배경 클릭으로 닫히지 않음 (b) ESC로 닫힘 (c) 기본 포커스가 의미 있는 요소에 위치
- 공수: M

3) 기본값/설정 적용 경로 정리(단일 출처 `SETTING_DEFAULTS` 강제)
- 기대효과: 설정 불일치 버그 감소, 신규 UI에서 기본값이 흔들리지 않음
- 리스크: 곳곳에 흩어진 `?? 25` 같은 값들이 발견되면 범위가 늘어날 수 있음
- DoD: 설정 기반 UI에서 기본값은 `SETTING_DEFAULTS`만 사용, 코드리뷰 체크 항목에 포함
- 공수: S~M

3-1) `persist` 스토리지 정책 정합성 확보(uiStore 중심)
- 기대효과: localStorage 금지 정책과 실제 동작 간 괴리를 제거해 “환경별 상태 불일치”를 줄임
- 리스크: 저장 계층(Dexie systemState)로 옮길 때 초기화/마이그레이션 고려가 필요
- DoD: theme 예외를 제외하고 localStorage에 의존하지 않도록 스토리지 경로가 문서/코드에서 일치
- 공수: M

4) Optional Chaining 방어적 접근 표준(중첩 상태 접근 안전화)
- 기대효과: 특정 사용자 데이터/동기화 타이밍에서 발생하는 크래시 예방
- 리스크: “안전”만 강조하다가 실제 버그를 숨길 수 있어, 빈 상태 UI를 함께 정의해야 함
- DoD: 중첩 객체 접근부는 `?.`/`??` 적용, 값이 없을 때의 빈 상태/대체 문구 정의
- 공수: S~M

5) 핵심 화면 빈 상태(Empty State) 정비
- 기대효과: 다음 행동이 분명해져 앱 이탈 감소
- 리스크: 빈 상태 CTA가 과도하면 산만해짐
- DoD: 일정/인박스/템플릿/목표 등에서 빈 상태 문구+단일 CTA 제공(“추가하기/가져오기” 등)
- 공수: M

### P1 (효율/학습 비용 감소: 플로우 개선)

1) “빠른 추가(Quick Add)”의 입력/피드백 일관화
- 기대효과: 작업 캡처 속도 개선, 입력 실패 감소
- 리스크: 단축키/모드 전환이 복잡하면 혼란 증가
- DoD: 단축키 진입 후 최소 입력으로 저장 완료, 실패 시 이유와 해결책 표시
- 공수: M

2) 작업 이동/배치 UX 단순화(드래그 + 키보드 대체 경로)
- 기대효과: 마우스 의존 감소, ADHD 사용자에게 조작 부담 감소
- 리스크: 키보드 조작은 학습이 필요하므로 힌트가 필요
- DoD: 드래그가 어려운 환경에서도 버튼/키보드로 “다음 블록으로 이동/현재 블록에 배치” 가능
- 공수: L

3) 완료 처리 피드백(진행/보상/되돌리기) 표준화
- 기대효과: 완료의 보상감을 즉시 제공, 실수 복구 가능
- 리스크: 되돌리기(Undo) 범위/시간 정책이 불명확하면 혼란
- DoD: 완료 시 단일 피드백 패턴(토스트/배너) + Undo 제공(가능한 범위에서)
- 공수: M

4) 리스트/캘린더 성능 최적화(리렌더/가상화는 필요 시)
- 기대효과: 스크롤/드래그 끊김 감소
- 리스크: 과한 최적화로 코드 복잡도 증가
- DoD: 프로파일링 기준으로 병목 1~2개만 해결, 체감 개선 확인
- 공수: M~L

5) 설정 화면 정보 구조 정리(그룹핑/설명/경고)
- 기대효과: 설정 탐색 시간 감소, 실수 설정 감소
- 리스크: 설정 위치 변경은 기존 사용자 혼란 유발
- DoD: 설정 항목 그룹화, 위험 설정은 명확한 설명/예시 제공
- 공수: M

### P2 (완성도/확장성: 품질과 유지보수)

1) UI 규칙 린트/리뷰 체크리스트화(“localStorage 금지” 등)
- 기대효과: 회귀 방지, 신규 기여자 온보딩 속도 개선
- 리스크: 형식만 남고 준수하지 않으면 무의미
- DoD: PR 템플릿/리뷰 체크에 4대 규칙 포함, 위반 시 수정 요청 기준 명확화
- 공수: S

2) 공통 컴포넌트/패턴 문서화(모달/토스트/빈 상태)
- 기대효과: 화면마다 다른 UX 감소
- 리스크: 문서와 실제 코드가 어긋날 수 있음
- DoD: 예제 스니펫/사용 가이드 제공, 신규 화면은 가이드 준수
- 공수: S~M

3) 접근성(키보드/포커스/aria) 1차 점검
- 기대효과: 집중 흐름 방해 감소, 기본 접근성 준수
- 리스크: 범위가 커지면 끝이 없음
- DoD: 핵심 화면에서 Tab 이동 가능, 모달 포커스 이동 정상, 주요 버튼에 적절한 라벨
- 공수: M

4) “동기화 로그/상태”의 사용자 친화 표현 개선(설정 내)
- 기대효과: 문제 발생 시 사용자가 스스로 진단 가능
- 리스크: 기술적 로그를 그대로 노출하면 난해
- DoD: 기술 용어 최소화, 재시도/지원 요청에 필요한 정보만 요약 제공
- 공수: M

5) 화면 간 내비게이션 일관화(뒤로/닫기/저장)
- 기대효과: 길 잃음 감소, 실수로 나가기 방지
- 리스크: 라우팅/상태 보존 정책 합의 필요
- DoD: “저장/취소/닫기/뒤로”의 의미가 화면 간 일관, 미저장 변경 시 안내
- 공수: M~L

---

## 4) ADHD 친화 UX 체크리스트(릴리즈 게이트)

릴리즈 전, 아래 항목을 **모두 통과**해야 한다.

1) 다음 행동이 항상 1개 이상 보인다
- 빈 상태/오류 상태에서 “무엇을 해야 하는지” CTA가 명확하다(1개 중심)

2) 상태가 즉시 보인다
- 로딩/저장/동기화/오류가 숨겨지지 않는다(조용히 실패 금지)

3) 실수 비용이 낮다
- 파괴적 액션은 확인 또는 되돌리기(Undo) 경로가 있다(가능 범위에서)

4) 모달은 예측 가능하다
- 배경 클릭으로 닫히지 않는다
- ESC로 닫힌다
- 열릴 때 포커스가 의미 있는 위치로 간다

5) 기본값은 항상 단일 출처를 따른다
- 기본값 하드코딩이 없다(`SETTING_DEFAULTS` 사용)

6) 크래시 방지(데이터 변형/동기화 타이밍)
- 중첩 상태 접근은 optional chaining으로 방어되어 있고, 값이 없을 때 빈 상태가 정의돼 있다

7) 주의 분산을 줄인다
- 한 화면에 동시에 “강한 CTA”가 1~2개를 넘지 않는다
- 토스트/배너는 중복 노출되지 않는다

8) 키보드 사용이 막히지 않는다
- 핵심 액션(추가/저장/닫기/완료)이 키보드로도 가능하거나 대체 경로가 있다

---

## 5) 작업 운영 방식(티켓 템플릿)

### 티켓 템플릿(복사해서 사용)

- 제목: [화면/도메인] 문제 한 줄 요약
- 배경/문제:
  - 사용자가 겪는 불편(재현 시나리오)
  - 현재 UX가 ADHD 관점에서 어려운 이유(인지부하/불확실성/실수 비용)
- 목표:
  - 개선 후 기대 행동/결과
- 범위(포함/제외):
  - 포함:
  - 제외(금지: backend/supabase/electron IPC 구현):
- 설계 메모(필요 시):
  - 데이터/상태 소스(Zustand/Repo)와 UI 표현 계획
- 구현 체크(프로젝트 규칙):
  - [ ] localStorage 사용 없음(예외: theme만)
  - [ ] 기본값은 `SETTING_DEFAULTS` 단일 출처
  - [ ] 중첩 접근 optional chaining 적용
  - [ ] 모달: 배경 클릭 닫기 금지 + ESC 닫기
- DoD(완료 기준):
  - [ ] 오류/빈 상태/로딩 상태 포함해 QA 가능
  - [ ] 주요 플로우 1개 이상 수동 테스트 시나리오 작성
  - [ ] 회귀 영향 범위(화면/컴포넌트) 체크 완료
- 리스크/롤백:
  - 잠재 회귀와 완화책
- 추정 공수: S / M / L

